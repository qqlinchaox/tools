/*!
* Ublue ContactsList v1.0
* Simulated IOS(iPhone) Alphabetical Contact List
*
* Copyright (c) 2015 梦幻神化 - http://www.bluesdream.com
* Licensed under the MIT License - 请保留此信息，如果您有修改或意见可通过网站给我留言。
*
* Create: 2015.11.30
*/
!function(t,e,o,n){t.fn.ublue_ContactsList=function(e){function n(e){for(var o,n,s,i=0;r[i].listOffset-e<=0&&(o=r[i],s=o.listBottom-e,s<-o.headerHeight&&(n=o),i++,!(i>=o.length)););0>s&&s>-o.headerHeight?(t(c.contactsHeader).addClass("isHidden"),t(o.list).addClass("isAnimated")):(t(c.contactsHeader).removeClass("isHidden"),o&&t(o.list).removeClass("isAnimated")),o&&t(c.contactsHeader).text(o.headerText)}function s(e,o){t(c.groupNav).find("li").each(function(){if(!(e<=t(this).offset().left||e>=t(this).offset().left+t(this).outerWidth()||o<=t(this).offset().top||o>=t(this).offset().top+t(this).outerHeight())){var n=i(t(this).attr("alt")),s=r[n].listOffset;t(c.contactsContent).stop().animate({scrollTop:s},0)}})}function i(t){for(var e=0;e<r.length;e++)if(r[e].headerText==t)return e}var a=t(this),r=[],c=t.extend({contactsHeader:".contacts-header",contactsContent:".contacts-content",group:".contacts-group",groupHeader:".contacts-group-hd",groupNav:".contacts-nav"},c),h=t(c.contactsHeader).outerHeight();a.find(c.group).each(function(e,o){var n=t(this),s=t(this).height(),i=t(this).position().top;r.push({headerText:t(this).find(c.groupHeader).text().toLowerCase(),headerHeight:h,list:n,listHeight:s,listOffset:i,listBottom:s+i})}),t(c.contactsHeader).text(r[0].headerText),t(c.contactsContent).scroll(function(e){e.stopPropagation(),n(t(this).scrollTop())}),o.querySelector(c.groupNav).addEventListener("touchmove",function(t){var e=t.changedTouches[0],n=o.elementFromPoint(e.pageX,e.pageY);n&&"LI"==n.nodeName&&s(e.clientX,e.clientY)});var l=function(t){t.addEventListener("touchstart",function(){var e=t.scrollTop,o=t.scrollHeight,n=e+t.offsetHeight;0===e?t.scrollTop=1:n===o&&(t.scrollTop=e-1)}),t.addEventListener("touchmove",function(e){t.offsetHeight<t.scrollHeight,e._isScroller=!0})};l(o.querySelector(c.contactsContent)),o.addEventListener("touchmove",function(t){t._isScroller||t.preventDefault()})}}(jQuery,window,document);